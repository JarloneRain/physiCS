> 在阅读本文前，建议温习一下田广善老师的量子力学课程中关于狄拉克符号的部分。

> 本文中提到的动量均是一维情况下的与坐标同方向的动量。

# 薛定谔方程四种写法

狄拉克符号的出现使得量子力学摆脱了表象的束缚，但由于其出现较晚，使得在使用上出现了很多和“旧写法”混用的现象。以薛定谔方程的动能项为例，按照波函数（本征态）和算符出现的形式是裸态还是坐标表象会看到以下四种写法：

$$
\begin{align}
    \frac {\hat p^2}{2m}&\left|\psi\right\rangle \\
    -\frac {\hbar^2}{2m}\frac {\partial ^2}{\partial x^2}&\left|\psi\right\rangle\\
    \frac {\hat p^2}{2m}&\psi\left(x\right)\\
    -\frac {\hbar^2}{2m}\frac {\partial ^2}{\partial x^2}&\psi\left(x\right) \\
\end{align}
$$

当然还有一类最不明所以的写法就是把波函数（本征态）的两种写法杂揉起来，变成 $\left|\psi\left(x\right)\right\rangle$ ，我们先把这种写法钉在耻辱柱上，然再来剖析上面的几种写法。事实上，只有 $\left(1\right)$ 和 $\left(4\right)$ 是较为严谨的写法。

# 当我们在计算概率时，我们到底在算什么

当你询问一个学习量子力学的人 $\rho\left(x\right)=\left|\psi\left(x\right)\right|^2$ 是什么时，即使是初学者也能告诉你这是在 $x$ 处发现粒子的概率密度，一些参考资料上也会告诉你历史上薛定谔曾倾向于将它解释为电荷或者质量的密度分布，最后是波恩提出了统计解释。

当我们学习到一些分立谱时，就拿新手最爱的一维无限深方势阱来说，记 $\left|\psi\right\rangle$ 是该情况下的随便一个本征态，我们很容易知道 $\left|c_n\right|^2=\left|\left\langle n\middle|\psi\right\rangle\right|^2$ 是粒子处在 $\left|n\right\rangle$  态上的概率。

但是，同样是做内积再取模平方，为什么左矢换了一下，就从概率密度变成单独某个态上的概率了呢？

事实上，狄拉克符号只告诉了我们不同的符号代表了不同的裸态，两个态的内积的模的平方告诉我们**左矢的裸态“落到”右矢表象时“命中”右矢裸态的概率**（当然你也可以把左右反过来）， $\psi\left(x\right)$ 不是 $\left|\psi\right\rangle$ 而是 $\left\langle x\middle|\psi\right\rangle$ ，所以 $\left|\psi\left(x\right)\right|^2=\left|\left\langle x\middle|\psi\right\rangle\right|^2$ ，再复习一下刚刚提到的两个态的内积的模的平方是什么？是用坐标表象去“看” $\left|\psi\right\rangle$ 时“看”到 $\left|x\right\rangle$ 的概率。那么 $\left|x\right\rangle$ 是什么？是坐标算符的本征态，是坐标轴上的一个点。所以， $\left|\psi\left(x\right)\right|^2$ 就是处在 $\left|\psi\right\rangle$ 的粒子在 $x$ 这个点被看到的概率，对连续的 $x$ ，当然就是概率密度了。因此，我们就从狄拉克符号的本质出发，推导出了波函数的几率解释。

最后再来处理 $c_n$ 的问题，一些资料上喜欢用 $\int\phi_n^*\left(x\right)\psi\left(x\right)\mathrm dx$ 来计算，但这并不本质，特别是如果你偷懒把 $\left(x\right)$ 省掉的话还会引起误解。其实这个公式是这么来的（先试试自己推导一下？）：

$$
\begin{align*}
    c_n &= \left\langle n \middle| \psi \right\rangle \\
        &= \int\mathrm dx \left\langle n \middle| x \right\rangle \left\langle x \middle| \psi \right\rangle \\
        &= \int\phi_n^*\left(x\right)\psi\left(x\right)\mathrm dx
\end{align*}
$$

所以只要掌握好狄拉克符号的核心思想，就不用再因为一会是概率密度、一会是概率，一会积分完要平方才有概率、一会又只积分就概率而记错公式了。

# 算符

现在我要问，动量算符 $\hat p$ 的表达式是什么？学过量子力学的你肯定会回答我：“在坐标表象下就是 $-\mathrm i\hbar\frac \partial {\partial x}$ ，在动量表象下就是 $p\times$ 。”

当然，这个回答只是拿来做题并没有什么问题，很多参考资料也会直接写 $\hat p=-\mathrm i\hbar\frac \partial {\partial x}$ ，但事实上，是不能用等号连接的。如果只是做题的时候写写 $\hat p\psi\left(x\right)$ ，那自然不会觉得有什么问题，但是如果我把 $\psi\left(x\right)$ 换成 $\left\langle x\middle|\psi\right\rangle$ 后，要怎么计算 $\hat p\left\langle x\right|$ 呢？

用算符左乘一个左矢，似乎从来没人说过要怎么计算，不过还好我们可以先试试看对分立谱的矩阵表示是什么样的，然后再推广回来就是。那么我们随便取一个角动量算符 $l=1$ 的本征态，然后我们就会惊喜的发现，角动量算符是一个三阶方阵，而左矢是一个三维行向量，根本无法相乘。

所以，这种写法是完全不严谨的，甚至不能写 $\hat p\left|\psi\right\rangle=-\mathrm i\hbar\frac \partial {\partial x}\psi\left(x\right)$ ，因为等号的左边是一个右矢而等号右边是一个（函）数。

那么要怎么才能把一个右矢变成函数呢？左乘一个左矢！所以正确的写法应该是 $\left\langle x\middle|\hat p\middle|\psi\right\rangle=-\mathrm i\hbar\frac \partial {\partial x}\psi\left(x\right)$ 。所以，考虑到 $\psi\left(x\right)=\left\langle x\middle|\psi\right\rangle$ ，“动量算符在坐标表象下是 $-\mathrm i\hbar\frac \partial {\partial x}$ ”的（不严谨的）数学表达应该是

$$
\left\langle x\right|\hat p=-\mathrm i\hbar\frac \partial {\partial x}\left\langle x\right|
$$

# 做道题试试

题目是陈鄂生量子力学的2.18：

> 设算符 $\hat H$ 具有连续的本征值，其本征函数 $u\left(x,\omega\right)$ 构成正交完备系。求方程
>
> $$
>    \left(\hat H-\omega_0\right)V\left(x\right)=F\left(x\right)
> $$
>
> 的解，其中 $F\left(x\right)$ 为已知函数， $\omega_0$ 为某个特定的本征值。

书中给出的解法是在坐标表象下完成的，我们来试试纯狄拉克符号的做法。

**解：**

题目等价于已知 $\hat H\left|\omega\right\rangle =\omega\left|\omega\right\rangle$ ， $\left\langle x\middle|\omega\right\rangle =u\left(x,\omega\right)$ ， $\left\langle x\middle|F\right\rangle =F\left(x\right)$ ，根据方程 $\left(\hat H-\omega_0\right)\left|V\right\rangle=\left|F\right\rangle$ 求 $\left\langle x\middle|V\right\rangle$ 。

$$
\begin{align*}
    \left(\hat H-\omega_0\right)\left|V\right\rangle&=\left|F\right\rangle \\
    \int\mathrm d\omega\left(\hat H-\omega_0\right)\left|\omega\right\rangle \left\langle \omega\middle|V\right\rangle&=\left|F\right\rangle \\
    \int\mathrm d\omega\left(\omega-\omega_0\right)\left|\omega\right\rangle \left\langle \omega\middle|V\right\rangle&=\left|F\right\rangle \\
    \int\mathrm d\omega\left(\omega-\omega_0\right)\left\langle \omega^\prime\middle|\omega\right\rangle \left\langle \omega\middle|V\right\rangle&=\left\langle \omega^\prime\middle|F\right\rangle \\
    \left(\omega^\prime-\omega_0\right)\left\langle \omega^\prime\middle|V\right\rangle&=\left\langle \omega^\prime\middle|F\right\rangle \\
    \left(\omega-\omega_0\right)\left\langle \omega\middle|V\right\rangle&=\left\langle \omega\middle|F\right\rangle \\
    \left\langle \omega\middle|V\right\rangle&=\frac {\left\langle \omega\middle|F\right\rangle}{\left(\omega-\omega_0\right)} \\
    \left\langle \omega\middle|V\right\rangle&=\frac {\int\mathrm dx \left\langle \omega\middle|x\right\rangle \left\langle x\middle|F\right\rangle}{\left(\omega-\omega_0\right)} \\
    \left\langle \omega\middle|V\right\rangle&=\frac {\int u^*\left(x,\omega\right)F\left(x\right)\mathrm dx}{\left(\omega-\omega_0\right)} \\
\end{align*}
$$

所以

$$
\begin{align*}
    V\left(x\right)
    &=\left\langle x\middle|V\right\rangle\\
    &=\int\mathrm d\omega \left\langle x\middle|\omega\right\rangle \left\langle \omega\middle|V\right\rangle \\
    &=\int u\left(x,\omega\right) \frac {\left\langle \omega\middle|F\right\rangle}{\left(\omega-\omega_0\right)}\mathrm d\omega\\
    &=\int u\left(x,\omega\right) \frac {\int u^*\left(x,\omega\right)F\left(x\right)\mathrm dx}{\left(\omega-\omega_0\right)}\mathrm d\omega\\
\end{align*}
$$

# 总结与展望

回到我们最开始的问题，为什么我说四种薛定谔方程中只有两种是严谨的呢？因为算符只能作用于裸态（左矢或者右矢），而求导只能作用于态函数。至于那个被我定在耻辱柱上的写法更是荒谬——裸态怎么能出现坐标表象的东西呢？

所以其实上面那道题目的写法也是有问题的，如果你拿到题目不先改造成裸态的形式的话，直接往里面扩展就会出现一个 $\int\mathrm d\omega\left(\omega-\omega_0\right)\left|\omega\right\rangle \left\langle \omega\right|V\left(x\right)=F\left(x\right)$ ,你没办法通过积分把中间的 $\omega$ 的外积消掉，如果乘以一个 $\left\langle \omega^\prime\right|$ 的左矢的话两边又会多出来一个左矢（除非你打算把薛定谔方程变成 $\hat H=E$ ，否则我不建议你约掉）无法处理。包括B站justchan7的解法中写的也是不严谨的。

当然，写这篇文章的目的是方便初学者更好地理解狄拉克符号和表象，而不是看到别人写法不严谨就去抬杠，符号背后的物理思想才是最重要的。

虽然一路推导下来基本已经自洽了，但其实还有一个漏洞：上述讨论是基于定态的，对含时的情况还没办法很好地处理。这部分内容可能需要我更加深入地学习一些绘景相关的知识甚至高量才能知道了。

$$
\Psi\left(x,t\right)\stackrel{?}=\left\langle x\middle|\Psi\left(t\right)\right\rangle \stackrel{?}=\mathrm e^{\mathrm i\omega t}\left\langle x\middle|\psi\right\rangle
$$